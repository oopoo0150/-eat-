<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.closet.great.dao.ProductDao">

	<!-- 상품 게시글 쓰기 -->
	<insert id="writeInsert" parameterType="product"><!-- 파라미터 타입은 bean alias -->
	INSERT INTO DEALBOARD (db_num, db_title, db_content, db_cate, db_sid, db_price) VALUES 
	(DEALBOARD_SEQ.NEXTVAL, #{db_title}, #{db_content}, default, #{db_sid},#{db_price})
	</insert>
	
	<!-- 상품 메인 리스트 출력 -->
	<select id="getProductList" resultType="product" parameterType="int">
		<![CDATA[SELECT * FROM DLIST_1 WHERE DROWNUM>=#{num}*10-9
		 AND DROWNUM<=#{num}*10]]>
	</select>
	
	<select id="getProductCount" resultType="int">
		SELECT COUNT(*) FROM DLIST_1
	</select>
	
	<!-- 상품 게시글 상세보기 -->
	<select id="getDetail" resultType="product" parameterType="int">
		SELECT * FROM DLIST WHERE DB_NUM=#{DB_NUM}
	</select>
	
	<!-- 상품 게시글 삭제(작성자, 관리자) -->
	<delete id="productDelete" parameterType="Integer">
		DELETE FROM DEALBOARD WHERE DB_NUM=#{DB_NUM}
	</delete>
	
	<!-- 상품 게시글 수정(작성자, 관리자) -->
	<update id="writeUpdate" parameterType="product">
		UPDATE DEALBOARD SET DB_TITLE=#{db_title}, DB_CONTENT=#{db_content}, 
		DB_VIEWS=#{db_views}, DB_SID=#{db_sid}, DB_PRICE=#{db_price},
		DB_COMPLAIN=#{db_complain} WHERE DB_NUM=#{db_num}
	</update>
	
	<!-- 상품 게시글 댓글 추가 -->
	<insert id="productR_insert" parameterType="productReply">
		INSERT INTO DEALBOARD_REPLY VALUES 
		(DEALBOARD_REPLY_SEQ.NEXTVAL, #{dbr_content}, default, #{dbr_complain}, 
		#{dbr_dbnum}, #{dbr_sid})
	</insert>
	
	<!-- 상품 게시글 댓글 리스트 출력 -->
	<select id="getPReplyList" parameterType="int" resultType="productReply">
		SELECT * FROM DEALBOARD_REPLY WHERE DBR_DBNUM=#{DB_NUM}
	</select>
	
	<!-- 상품 게시글 댓글 삭제 -->
	<delete id="productR_delete" parameterType="Integer">
		DELETE FROM DEALBOARD_REPLY WHERE DBR_NUM=#{dbr_num}
	</delete>
	
</mapper>
















